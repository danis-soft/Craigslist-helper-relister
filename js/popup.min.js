const e="renew_listing",n="get_listings",t="clear_nevershown_listings",o="reset_and_interput_poster",l="popup",i="content",c="background";function s(n){var i;n,console.log("received message from content script: "),void 0!==n&&null!=n&&(console.log(n),console.log(typeof n)),void 0!==n&&null!=n&&Object.keys(n).length>0?function(n){var o;chrome.tabs.query({active:!0,currentWindow:!0},(e=>{o=e[0].id}));var i="";i='<table width="500px" border="1">',console.log(n),console.log(typeof n);var s=["#e1e3fa","#ffffff"],d=0,p=!1,u=0;for(var v in n)n.hasOwnProperty(v)&&(0==p&&(p=!0,i+="<tr class='header'>",i+=`<td bgcolor="${s[d]}"><input type="checkbox" id="checkall_items_renew" name="checkall_renew" class="listing_control" value="checkall">Renew</td>`,i+=`<td class="listing_control" bgcolor="${s[d]}"><b>Check/Uncheck all</b></td>`,i+=`<td bgcolor="${s[d]}"><input type="checkbox" id="checkall_items_nevershow" name="checkall_nevershow" class="listing_control" value="checkall">Never show</td>`,i+="</tr>",d=++d%s.length),console.log(v+":"+n[v]),i+=`<tr id="${u}_listing">`,i+=`<td class="col_renew_check" bgcolor="${s[d]}"><input type="checkbox" name="item_renew" class="listing_renew" value="${v}"></td>`,i+=`<td class="listing_title" bgcolor="${s[d]}">${n[v].title}</td>`,i+=`<td bgcolor="${s[d]}"><input type="checkbox" name="item_nevershow" class="listing_nevershow" value="${v}"></td>`,i+="</tr>",d=++d%s.length);i+="</table>",i+='<p><input type="button" id="btnSubmit" value="Submit"></input>',a(i+='<input type="button" id="btnClearNeverShown" value="Reset never shown items"></input></p>'),g(!1);var _=new Array,w=new Array;$(".listing_nevershow").on("change",(function(){var e=$(this).prop("checked"),n=$(this).parent().parent();n.find(".listing_renew").prop("disabled",e),e?(n.find(".listing_renew").prop("checked",!1),n.addClass("nevershow")):n.removeClass("nevershow")})),$("#checkall_items_renew").on("change",(function(){var e=$("#checkall_items_renew").prop("checked");console.log("Global Action: "+e),$("input:checkbox.listing_renew").each((function(){$(this).prop("checked",e)}))})),$("#checkall_items_nevershow").on("change",(function(){var e=$("#checkall_items_nevershow").prop("checked");$("#checkall_items_renew").prop("checked",!1),$("#checkall_items_renew").prop("disabled",e),console.log("Global Action: "+e),$("input:checkbox.listing_nevershow").each((function(){$(this).prop("checked",e);var n=$(this).parent().parent();n.find(".listing_renew").prop("disabled",e),e?(n.find(".listing_renew").prop("checked",!1),n.addClass("nevershow")):n.removeClass("nevershow")}))})),$("#btnClearNeverShown").click((()=>{h(t,l,c,null,null)})),$("#btnSubmit").click((()=>{_.length=0,w.length=0,_=r("input:checkbox.listing_renew",n),w=r("input:checkbox.listing_nevershow",n),(_.length>0||w.length>0)&&(console.log("sending a message to BACKGROUND from POPUP with RENEW subject"),console.log("There are "+_.length+" items in aUrls array"),h(e,l,c,{active_tab:o,payload:{renew:_,nevershow:w}},null))}))}(n):(i="",i+="<div><b>No listings found!</b></div>",a(i+='<input type="button" id="btnResetEverything" value="Reset Craigslist reposter"></input>'),g(!1),$("#btnResetEverything").click((()=>{console.log("sending RESET_AND_INTERRUPT_POSTER message to background"),h(o,l,c,null,null)})))}function r(e,n){var t=[];return $(e).each((function(){if(this.checked){var e=$(this).val(),o=$(this).parent().html();console.log("Parent: "+o),console.log("Checkbox checked for value: "+e),t.push(n[e])}})),t}function a(e){$(e).appendTo("#content_container")}function h(e,n,t,o,l){chrome.runtime.sendMessage({from:n,to:t,type:e,value:o},l)}function d(e){return!(void 0===e||!e)}function g(e=!0){e?$("#loading_image").show("medium"):$("#loading_image").hide("slow")}function p(){window.close()}window.addEventListener("DOMContentLoaded",(function(){var e,t,o,c,r,a;console.log("initiating event listener"),e=n,t=l,o=i,c="",r=s,a=p,chrome.tabs.query({active:!0,currentWindow:!0},(n=>{var l=n[0];d(l)&&(l.url.search(/((http)(s)?:\/\/)?(accounts|post).craigslist.org\/.*/)>-1?chrome.tabs.sendMessage(l.id,{from:t,to:o,type:e,value:c},r):d(a)&&a())}))}));